<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <title>Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f3f8f2;
      margin: 0;
      padding: 20px;
      text-align: center;
    }

    .card {
      background: #1b5e20;
      color: white;
      padding: 20px;
      border-radius: 15px;
      margin-bottom: 15px;
    }

    .prayer {
      background: white;
      padding: 15px;
      border-radius: 12px;
      margin: 10px 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 18px;
    }

    button {
      background: #1b5e20;
      color: white;
      border: none;
      padding: 12px 20px;
      border-radius: 10px;
      font-size: 16px;
      cursor: pointer;
      margin: 10px 0;
    }

    input[type="checkbox"] {
      transform: scale(1.3);
    }
  </style>
</head>

<body>

  <div class="card">
    <h2>Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</h2>
    <p id="status">Ø§Ø¶ØºØ· Ù„ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</p>
  </div>

  <button onclick="enableLocation()">ğŸ“ ØªÙØ¹ÙŠÙ„ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ</button>
  <button onclick="enableAlerts()">ğŸ”” ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ø°Ø§Ù†</button>

  <!-- Ø§Ù„ØµÙ„ÙˆØ§Øª -->
  <div class="prayer">
    <span>Ø§Ù„ÙØ¬Ø±</span>
    <span id="fajr">--</span>
    <input type="checkbox" id="alarm-fajr" checked>
  </div>

  <div class="prayer">
    <span>Ø§Ù„Ø´Ø±ÙˆÙ‚</span>
    <span id="sunrise">--</span>
  </div>

  <div class="prayer">
    <span>Ø§Ù„Ø¸Ù‡Ø±</span>
    <span id="dhuhr">--</span>
    <input type="checkbox" id="alarm-dhuhr" checked>
  </div>

  <div class="prayer">
    <span>Ø§Ù„Ø¹ØµØ±</span>
    <span id="asr">--</span>
    <input type="checkbox" id="alarm-asr" checked>
  </div>

  <div class="prayer">
    <span>Ø§Ù„Ù…ØºØ±Ø¨</span>
    <span id="maghrib">--</span>
    <input type="checkbox" id="alarm-maghrib" checked>
  </div>

  <div class="prayer">
    <span>Ø§Ù„Ø¹Ø´Ø§Ø¡</span>
    <span id="isha">--</span>
    <input type="checkbox" id="alarm-isha" checked>
  </div>

  <!-- ØµÙˆØª Ø§Ù„Ø£Ø°Ø§Ù† -->
  <audio id="adhan" src="https://www.islamicfinder.org/prayer-times/adhaan/makkah_5.mp3"></audio>

  <script>
    let alertsEnabled = false;

    function enableLocation() {
      if (!navigator.geolocation) {
        alert("Ø§Ù„Ù…ØªØµÙØ­ Ù„Ø§ ÙŠØ¯Ø¹Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ø¬ØºØ±Ø§ÙÙŠ");
        return;
      }

      navigator.geolocation.getCurrentPosition(
        pos => {
          document.getElementById("status").innerText = "âœ… ØªÙ… ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø¨Ù†Ø¬Ø§Ø­";
          loadPrayerTimes(pos.coords.latitude, pos.coords.longitude);
        },
        () => {
          document.getElementById("status").innerText = "âŒ Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø³Ù…Ø§Ø­ Ø¨Ø§Ù„Ù…ÙˆÙ‚Ø¹";
        }
      );
    }

    function loadPrayerTimes(lat, lon) {
      const today = new Date();
      const date = `${today.getDate()}-${today.getMonth() + 1}-${today.getFullYear()}`;

      fetch(`https://api.aladhan.com/v1/timings/${date}?latitude=${lat}&longitude=${lon}&method=2`)
        .then(res => res.json())
        .then(data => {
          const t = data.data.timings;
          document.getElementById("fajr").innerText = t.Fajr;
          document.getElementById("sunrise").innerText = t.Sunrise;
          document.getElementById("dhuhr").innerText = t.Dhuhr;
          document.getElementById("asr").innerText = t.Asr;
          document.getElementById("maghrib").innerText = t.Maghrib;
          document.getElementById("isha").innerText = t.Isha;
        });
    }

    function enableAlerts() {
      alertsEnabled = true;
      const a = document.getElementById("adhan");
      a.play();
      setTimeout(() => a.pause(), 2000);
      alert("ØªÙ… ØªÙØ¹ÙŠÙ„ ØªÙ†Ø¨ÙŠÙ‡Ø§Øª Ø§Ù„Ø£Ø°Ø§Ù†");
    }

    setInterval(() => {
      if (!alertsEnabled) return;

      const now = new Date();
      const current = now.getHours() + ":" + now.getMinutes().toString().padStart(2, "0");

      check("fajr", current);
      check("dhuhr", current);
      check("asr", current);
      check("maghrib", current);
      check("isha", current);
    }, 60000);

    function check(name, time) {
      const t = document.getElementById(name).innerText;
      const enabled = document.getElementById("alarm-" + name)?.checked;

      if (enabled && t === time) {
        document.getElementById("adhan").play();
      }
    }
  </script>

</body>
</html>
