<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ğŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø© â€“ ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ©</title>

<meta name="theme-color" content="#1b5e20">

<style>
body{
  font-family: Tahoma;
  background:#f4f9f4;
  margin:0;
  padding:15px;
  text-align:center;
}
.header{
  background:#1b5e20;
  color:#fff;
  padding:20px;
  border-radius:20px;
}
.sadaqa{
  margin-top:10px;
  font-size:14px;
  color:#e8f5e9;
  line-height:1.8;
}
.countdown{
  margin:15px 0;
  font-size:18px;
  color:#1b5e20;
}
.card{
  background:#fff;
  margin:12px 0;
  padding:15px;
  border-radius:18px;
  box-shadow:0 3px 10px rgba(0,0,0,.1);
}
.prayer{
  display:flex;
  justify-content:space-between;
  align-items:center;
}
.prayer-name{
  font-weight:bold;
  color:#1b5e20;
}
.controls{
  display:flex;
  gap:6px;
  margin-top:8px;
}
select,button{
  padding:6px;
  border-radius:10px;
  border:1px solid #1b5e20;
}
#duaBox{
  background:#ffffff;
  margin:15px 0;
  padding:18px;
  border-radius:18px;
  box-shadow:0 2px 8px rgba(0,0,0,.1);
  font-size:16px;
  line-height:2;
  color:#1b5e20;
  transition:opacity 0.5s ease-in-out;
}
#downloadBtn{
  background:#1b5e20;
  color:white;
  padding:10px 20px;
  border:none;
  border-radius:15px;
  font-size:16px;
  margin:15px 0;
}
</style>
</head>

<body>

<div class="header">
  <h2>ğŸ•Œ Ù…ÙˆØ§Ù‚ÙŠØª Ø§Ù„ØµÙ„Ø§Ø©</h2>
  <div class="sadaqa">
    ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ù„Ø±ÙˆØ­ Ù…Ù†Ù‰ Ù†Ø§Ø¬ÙŠ Ø¹Ù„ÙŠ Ø£Ø­Ù…Ø¯  
    <br>Ø±Ø­Ù…Ù‡Ø§ Ø§Ù„Ù„Ù‡ Ø±Ø­Ù…Ø©Ù‹ ÙˆØ§Ø³Ø¹Ø© ğŸ¤  
    <br>Ø§Ø¨Ù†Ùƒ Ø§Ù„Ù…Ø®Ù„Øµ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…Ø¯
  </div>
  <p id="location">â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹...</p>
</div>

<div class="countdown" id="countdown">â³ Ø¬Ø§Ø±ÙŠ Ø§Ù„Ø­Ø³Ø§Ø¨...</div>

<div id="duaBox">ğŸ¤² Ø¬Ø§Ø±ÙŠ Ø¹Ø±Ø¶ Ø§Ù„Ø¯Ø¹Ø§Ø¡...</div>

<button id="downloadBtn" onclick="downloadAdhan()">â¬‡ï¸ ØªØ­Ù…ÙŠÙ„ Ø£ØµÙˆØ§Øª Ø§Ù„Ø£Ø°Ø§Ù†</button>
<p id="downloadStatus"></p>

<div id="prayers"></div>

<audio id="adhan"></audio>

<script>
const prayerNames={
  Fajr:'Ø§Ù„ÙØ¬Ø±',
  Dhuhr:'Ø§Ù„Ø¸Ù‡Ø±',
  Asr:'Ø§Ù„Ø¹ØµØ±',
  Maghrib:'Ø§Ù„Ù…ØºØ±Ø¨',
  Isha:'Ø§Ù„Ø¹Ø´Ø§Ø¡'
};

const adhanSounds=[
  {name:'Ø£Ø°Ø§Ù† Ù…ÙƒØ©',file:'adhan1.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ø§Ù„Ù…Ø¯ÙŠÙ†Ø©',file:'adhan2.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ø§Ù„Ø­Ø±Ù…',file:'adhan3.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ø§Ù„Ø£Ù‚ØµÙ‰',file:'adhan4.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ù…ØµØ±',file:'adhan5.mp3'},
  {name:'Ø£Ø°Ø§Ù† ØªØ±ÙƒÙŠ',file:'adhan6.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ù…ØºØ±Ø¨ÙŠ',file:'adhan7.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ø­Ø¬Ø§Ø²ÙŠ',file:'adhan8.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ù‡Ø§Ø¯Ø¦',file:'adhan9.mp3'},
  {name:'Ø£Ø°Ø§Ù† Ø§Ù†Ø¯ÙˆÙ†ÙŠØ³ÙŠ',file:'adhan10.mp3'}
];

const duas=[
  "Ø§Ù„Ù„Ù‡Ù… Ø§ØºÙØ± Ù„Ø£Ù…ÙŠ Ù…Ù†Ù‰ Ù†Ø§Ø¬ÙŠ Ø¹Ù„ÙŠ Ø£Ø­Ù…Ø¯ØŒ ÙˆØ§Ø±Ø­Ù…Ù‡Ø§ Ø±Ø­Ù…Ø©Ù‹ ÙˆØ§Ø³Ø¹Ø© ğŸ¤",
  "Ø§Ù„Ù„Ù‡Ù… Ù†ÙˆÙ‘Ø± Ù‚Ø¨Ø± Ø£Ù…ÙŠ ÙˆØ§Ø¬Ø¹Ù„Ù‡Ø§ Ù…Ù† Ø£Ù‡Ù„ Ø§Ù„ÙØ±Ø¯ÙˆØ³ Ø§Ù„Ø£Ø¹Ù„Ù‰ ğŸ¤²",
  "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø¹Ù„ ÙƒÙ„ ØµÙ„Ø§Ø© ÙˆØ£Ø°Ø§Ù† ÙÙŠ Ù…ÙŠØ²Ø§Ù† Ø­Ø³Ù†Ø§Øª Ø£Ù…ÙŠ ğŸŒ¿",
  "Ø§Ù„Ù„Ù‡Ù… Ø§Ø¬Ø²Ù Ø£Ù…ÙŠ Ø¹Ù†ÙŠ Ø®ÙŠØ± Ø§Ù„Ø¬Ø²Ø§Ø¡ ÙˆØ¨Ø¯Ù‘Ù„ Ø­Ø²Ù†Ù‡Ø§ ÙØ±Ø­Ù‹Ø§ ğŸ¤",
  "ØµØ¯Ù‚Ø© Ø¬Ø§Ø±ÙŠØ© Ù„Ø±ÙˆØ­ Ø£Ù…ÙŠ â€” Ø§Ø¨Ù†Ù‡Ø§ Ø§Ù„Ù…Ø®Ù„Øµ Ù…Ø­Ù…Ø¯ Ø¹Ø¨Ø¯Ø§Ù„Ù„Ù‡ Ù…Ø­Ù…Ø¯ ğŸ¤"
];

let duaIndex=0;
function rotateDua(){
  const box=document.getElementById("duaBox");
  box.style.opacity=0;
  setTimeout(()=>{
    box.innerText=duas[duaIndex];
    box.style.opacity=1;
    duaIndex=(duaIndex+1)%duas.length;
  },500);
}
rotateDua();
setInterval(rotateDua,10000);

/* â­ ØªØ­Ø³ÙŠÙ† ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹ */
function getLocation(){
  const saved = localStorage.getItem("last_location");

  if(saved){
    const data = JSON.parse(saved);
    document.getElementById("location").innerText="ğŸ“ ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ø§Ù„Ù…Ø­ÙÙˆØ¸";
    showTimings(data.timings);
  }

  navigator.geolocation.getCurrentPosition(pos=>{
    loadTimings(pos.coords.latitude,pos.coords.longitude);
  },()=>{
    if(!saved){
      document.getElementById("location").innerText="âŒ ØªØ¹Ø°Ù‘Ø± ØªØ­Ø¯ÙŠØ¯ Ø§Ù„Ù…ÙˆÙ‚Ø¹";
    }
  },{
    enableHighAccuracy:true,
    timeout:7000,
    maximumAge:3600000
  });
}

async function loadTimings(lat,lon){
  document.getElementById("location").innerText="ğŸ“¡ ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù…ÙˆÙ‚Ø¹...";
  const res=await fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=0`);
  const data=await res.json();

  localStorage.setItem("last_location",JSON.stringify({
    lat:lat,
    lon:lon,
    timings:data.data.timings
  }));

  showTimings(data.data.timings);
  document.getElementById("location").innerText="ğŸ“ Ø§Ù„Ù…ÙˆÙ‚Ø¹ Ù…Ø­Ø¯Ù‘Ø«";
}

function showTimings(t){
  let html='';
  let now=new Date();
  let nextTime=null;
  let nextName='';

  for(let k in prayerNames){
    let [h,m]=t[k].split(':');
    let pt=new Date();
    pt.setHours(h,m,0);

    if(pt>now && !nextTime){
      nextTime=pt;
      nextName=prayerNames[k];
    }

    html+=`
    <div class="card">
      <div class="prayer">
        <div class="prayer-name">${prayerNames[k]}</div>
        <div>${t[k]}</div>
      </div>
      <div class="controls">
        <select onchange="localStorage.setItem('sound_${k}',this.value)">
          ${adhanSounds.map(a=>`<option value="${a.file}">${a.name}</option>`).join('')}
        </select>
        <button onclick="playAdhan('${k}')">ğŸ””</button>
      </div>
    </div>`;
  }

  document.getElementById("prayers").innerHTML=html;
  startCountdown(nextTime,nextName);
}

function playAdhan(p){
  const audio=document.getElementById("adhan");
  audio.src=localStorage.getItem('sound_'+p)||adhanSounds[0].file;
  audio.play();
}

function startCountdown(time,name){
  setInterval(()=>{
    let diff=time-new Date();
    if(diff<0) return;
    let m=Math.floor(diff/60000);
    let s=Math.floor((diff%60000)/1000);
    document.getElementById("countdown").innerText=
      `Ø§Ù„ØµÙ„Ø§Ø© Ø§Ù„Ù‚Ø§Ø¯Ù…Ø©: ${name} Ø¨Ø¹Ø¯ ${m} Ø¯Ù‚ÙŠÙ‚Ø© Ùˆ ${s} Ø«Ø§Ù†ÙŠØ©`;
  },1000);
}

async function downloadAdhan(){
  const s=document.getElementById("downloadStatus");
  s.innerText="â³ Ø¬Ø§Ø±ÙŠ ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø£Ø°Ø§Ù†...";
  for(let a of adhanSounds){
    await fetch(a.file,{cache:"reload"});
  }
  s.innerText="âœ… ØªÙ… ØªØ­Ù…ÙŠÙ„ Ø£ØµÙˆØ§Øª Ø§Ù„Ø£Ø°Ø§Ù†";
}

getLocation();
</script>

</body>
</html>
